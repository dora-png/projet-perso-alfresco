define(["dojo/_base/declare","alfresco/header/AlfSitesMenu","alfresco/core/CoreXhr","dojo/_base/lang","dojo/_base/array","dojo/aspect","dijit/registry","alfresco/menus/AlfMenuGroup","alfresco/header/AlfMenuItem","alfresco/header/AlfCascadingMenu","dojo/dom-style","dijit/popup"],function(h,k,n,e,l,b,c,m,f,a,j,d){return h([k,n],{_addMenuItem:function g(r,q,o){if(r==this.recentGroup){var p=new m({widgets:[{name:"alfresco/header/AlfMenuItem",config:{label:"Loading..."}}]});var s=new a(q.config);s.popup.onOpen=dojo.hitch(this,"loadSitePages",q.config.siteShortName,p);s.popup.addChild(p);r.addChild(s)}else{this.inherited(arguments)}},_sitePagesLoaded:null,loadSitePages:function i(o,p){if(this._sitePagesLoaded!=null&&this._sitePagesLoaded[o]==true){this.alfLog("log","Site pages already loaded for: "+o)}else{this.alfLog("log","Loading pages for site: "+o);this.serviceXhr({url:Alfresco.constants.URL_SERVICECONTEXT+"tutorials/site/"+o,method:"GET",siteShortName:o,sitePageList:p,successCallback:this.sitePagesLoaded,callbackScope:this})}},sitePagesLoaded:function i(p,o){this.alfLog("log","Site pages data loaded successfully",p);if(this._sitePagesLoaded==null){this._sitePagesLoaded={}}this._sitePagesLoaded[o.siteShortName]=true;var q=(o.sitePageList&&o.sitePageList.getChildren().length>0&&o.sitePageList.getChildren()[0].focused);l.forEach(o.sitePageList.getChildren(),function(s,r){o.sitePageList.removeChild(s)});if(p.sitePages&&p.sitePages.length>0){l.forEach(p.sitePages,function(r,s){this.alfLog("log","Adding site page menu item",r);var t=new f(r);o.sitePageList.addChild(t)},this)}else{}if(q){o.sitePageList.focusFirstChild()}}})});